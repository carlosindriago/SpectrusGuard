{
    "version": "1.0.0",
    "description": "SpectrusGuard WAF Rules - Regex patterns for detecting web attacks",
    "last_updated": "2026-01-26",
    
    "sqli": [
        "/(union\\s+(all\\s+)?select)/i",
        "/(select\\s+.*\\s+from\\s+)/i",
        "/(insert\\s+into\\s+.*\\s+values)/i",
        "/(update\\s+.*\\s+set\\s+)/i",
        "/(delete\\s+from\\s+)/i",
        "/(drop\\s+(table|database|index))/i",
        "/(truncate\\s+table)/i",
        "/(alter\\s+table)/i",
        "/(exec\\s*\\(|execute\\s*\\()/i",
        "/(;\\s*shutdown)/i",
        "/(\\bor\\b|\\band\\b)\\s*[\\d\"'=]+\\s*[=<>]+\\s*[\\d\"'=]+/i",
        "/(\\bor\\b|\\band\\b)\\s*['\"][^'\"]*['\"]\\s*[=<>]/i",
        "/('\\s*(or|and)\\s*'[^']*'\\s*=\\s*')/i",
        "/(\"\\s*(or|and)\\s*\"[^\"]*\"\\s*=\\s*\")/i",
        "/(--\\s*$|;--)/",
        "/(#.*$)/",
        "/(1\\s*=\\s*1|'1'\\s*=\\s*'1')/i",
        "/(sleep\\s*\\(|benchmark\\s*\\(|waitfor\\s+delay)/i",
        "/(load_file\\s*\\(|into\\s+(out|dump)file)/i",
        "/(@@version|information_schema|mysql\\.user)/i",
        "/(char\\s*\\(|concat\\s*\\(|concat_ws\\s*\\()/i",
        "/(group_concat\\s*\\()/i",
        "/(having\\s+[\\d\\w]+\\s*[=<>])/i",
        "/(order\\s+by\\s+\\d+)/i",
        "/(null\\s*,\\s*null|null\\s+null)/i"
    ],
    
    "xss": [
        "/<script[^>]*>.*?<\\/script>/is",
        "/<script[^>]*>/i",
        "/javascript\\s*:/i",
        "/vbscript\\s*:/i",
        "/on(load|error|click|mouse|focus|blur|key|submit|reset|change|select|abort|dblclick|drag|drop|input|invalid|scroll|wheel|copy|cut|paste|beforeunload|hashchange|message|offline|online|pagehide|pageshow|popstate|resize|storage|unload|animationend|animationiteration|animationstart|transitionend)\\s*=/i",
        "/<iframe[^>]*>/i",
        "/<object[^>]*>/i",
        "/<embed[^>]*>/i",
        "/<link[^>]+href\\s*=\\s*[\"'][^\"']*javascript:/i",
        "/<img[^>]+src\\s*=\\s*[\"'][^\"']*javascript:/i",
        "/<svg[^>]*onload/i",
        "/<math[^>]*>/i",
        "/expression\\s*\\(/i",
        "/@import\\s+/i",
        "/behavior\\s*:/i",
        "/binding\\s*:/i",
        "/-moz-binding\\s*:/i",
        "/data\\s*:\\s*text\\/html/i",
        "/<base[^>]+href/i",
        "/<form[^>]+action\\s*=\\s*[\"'][^\"']*javascript:/i",
        "/document\\.(cookie|domain|write|location)/i",
        "/window\\.(location|open|eval)/i",
        "/eval\\s*\\(/i",
        "/alert\\s*\\(/i",
        "/confirm\\s*\\(/i",
        "/prompt\\s*\\(/i",
        "/fromCharCode/i",
        "/innerHTML\\s*=/i",
        "/outerHTML\\s*=/i"
    ],
    
    "traversal": [
        "/\\.\\.[\\/\\\\]/",
        "/(\\.\\.%2f|%2e%2e%2f|%2e%2e\\/)/i",
        "/(\\.\\.%5c|%2e%2e%5c|%2e%2e\\\\)/i",
        "/\\.\\.\\.\\//",
        "/(etc\\/passwd|etc\\/shadow|etc\\/hosts)/i",
        "/(windows\\/system32|windows\\\\system32)/i",
        "/(boot\\.ini|win\\.ini)/i",
        "/(proc\\/self|proc\\/version|proc\\/cmdline)/i",
        "/(\\/var\\/log|\\/var\\/www)/i",
        "/(wp-config\\.php)/i",
        "/(\\.htaccess|\\.htpasswd)/i",
        "/(web\\.config|applicationHost\\.config)/i",
        "/(php:\\/\\/filter|php:\\/\\/input)/i",
        "/(file:\\/\\/|file%3a%2f%2f)/i",
        "/(\\x00|%00)/",
        "/(\\\\x00|\\\\0)/",
        "/\\.ph(p[345s]?|t|tml)\\./i"
    ],
    
    "rce": [
        "/(system|exec|shell_exec|passthru|popen|proc_open)\\s*\\(/i",
        "/(eval|assert|create_function)\\s*\\(/i",
        "/(call_user_func|call_user_func_array)\\s*\\(/i",
        "/(preg_replace\\s*\\([^)]*\\/[^)]*e)/i",
        "/(\\$\\{|\\$\\(|`[^`]+`)/",
        "/(\\|\\s*(cat|ls|id|whoami|uname|pwd|wget|curl|nc|bash|sh|perl|python|ruby|php))/i",
        "/(;\\s*(cat|ls|id|whoami|uname|pwd|wget|curl|nc|bash|sh|perl|python|ruby|php))/i",
        "/(&&\\s*(cat|ls|id|whoami|uname|pwd|wget|curl|nc|bash|sh|perl|python|ruby|php))/i",
        "/(\\|\\|\\s*(cat|ls|id|whoami|uname|pwd|wget|curl|nc|bash|sh|perl|python|ruby|php))/i",
        "/(\\/bin\\/(bash|sh|dash|zsh|csh|tcsh))/i",
        "/(wget\\s+|curl\\s+|fetch\\s+)/i",
        "/(nc\\s+-[a-z]*\\s+)/i",
        "/(python\\s+-c|perl\\s+-e|ruby\\s+-e|php\\s+-r)/i",
        "/(base64_decode\\s*\\()/i",
        "/(gzinflate|gzuncompress|gzdecode|str_rot13)\\s*\\(/i",
        "/(\\$_(GET|POST|REQUEST|COOKIE|SERVER|FILES)\\s*\\[)/",
        "/(include|include_once|require|require_once)\\s*\\(\\s*[\\$\"']/i",
        "/(chr\\s*\\(\\s*\\d+\\s*\\)\\s*\\.?)+/i",
        "/(move_uploaded_file|copy|rename|unlink|rmdir)\\s*\\(/i"
    ],
    
    "lfi": [
        "/(include|include_once|require|require_once)\\s*\\(\\s*['\"][^'\"]*\\.\\.\\//i",
        "/(include|include_once|require|require_once)\\s*\\(\\s*\\$_(GET|POST|REQUEST|COOKIE)/i",
        "/php:\\/\\/filter/i",
        "/php:\\/\\/input/i",
        "/expect:\\/\\//i",
        "/zip:\\/\\//i",
        "/phar:\\/\\//i",
        "/data:\\/\\//i",
        "/glob:\\/\\//i",
        "/ssh2:\\/\\//i",
        "/rar:\\/\\//i",
        "/ogg:\\/\\//i",
        "/(compress\\.zlib|compress\\.bzip2):\\/\\//i",
        "/file_get_contents\\s*\\(\\s*[\\$\"'][^)]*\\.\\.\\//i",
        "/fopen\\s*\\(\\s*[\\$\"'][^)]*\\.\\.\\//i",
        "/readfile\\s*\\(\\s*[\\$\"'][^)]*\\.\\.\\//i",
        "/file\\s*\\(\\s*[\\$\"'][^)]*\\.\\.\\//i"
    ],
    
    "upload": [
        "/\\.(php[345s]?|phtml|phar|phps)$/i",
        "/\\.(asp|aspx|ascx|ashx|asmx|asa|asax|axd)$/i",
        "/\\.(jsp|jspx|jsw|jsv|jtml)$/i",
        "/\\.(cgi|pl|py|rb|sh|bash|exe|bat|cmd|com|dll|msi|vbs|vbe|js|ws|wsf|wsc|wsh|ps1|psm1)$/i",
        "/\\.(htaccess|htpasswd)$/i",
        "/(application\\/x-php|text\\/x-php)/i",
        "/(application\\/x-httpd-php)/i"
    ],
    
    "scanner": [
        "/(nikto|sqlmap|nmap|nessus|acunetix|w3af|vega)/i",
        "/(openvas|burp|zap|havij|dirbuster|gobuster)/i",
        "/(wpscan|joomscan|droopescan)/i",
        "/(masscan|whatweb|wafw00f)/i",
        "/(\\$\\{jndi:|\\$\\{env:|\\$\\{sys:)/i"
    ],
    
    "spam": [
        "/(viagra|cialis|casino|poker|lottery|prize|winner)/i",
        "/(click here|act now|limited time|urgent)/i",
        "/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z]{2,}).*([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z]{2,}).*([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z]{2,})/i"
    ]
}
